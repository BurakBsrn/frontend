{"ast":null,"code":"import _regeneratorRuntime from\"/home/burak/projects/chat/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";var _marked=/*#__PURE__*/_regeneratorRuntime.mark(login),_marked2=/*#__PURE__*/_regeneratorRuntime.mark(logout),_marked3=/*#__PURE__*/_regeneratorRuntime.mark(register),_marked4=/*#__PURE__*/_regeneratorRuntime.mark(forgetPassword),_marked5=/*#__PURE__*/_regeneratorRuntime.mark(watchLoginUser),_marked6=/*#__PURE__*/_regeneratorRuntime.mark(watchLogoutUser),_marked7=/*#__PURE__*/_regeneratorRuntime.mark(watchRegisterUser),_marked8=/*#__PURE__*/_regeneratorRuntime.mark(watchForgetPassword),_marked9=/*#__PURE__*/_regeneratorRuntime.mark(authSaga);import{all,call,fork,put,takeEvery}from'redux-saga/effects';import{APIClient}from'../../helpers/apiClient';import{getFirebaseBackend}from\"../../helpers/firebase\";import{LOGIN_USER,LOGOUT_USER,REGISTER_USER,FORGET_PASSWORD}from'./constants';import{loginUserSuccess,registerUserSuccess,forgetPasswordSuccess,apiError}from'./actions';//Initilize firebase\nvar fireBaseBackend=getFirebaseBackend();/**\r\n * Sets the session\r\n * @param {*} user \r\n */var create=new APIClient().create;/**\r\n * Login the user\r\n * @param {*} payload - username and password \r\n */function login(_ref){var _ref$payload,username,password,history,response,_response;return _regeneratorRuntime.wrap(function login$(_context){while(1){switch(_context.prev=_context.next){case 0:_ref$payload=_ref.payload,username=_ref$payload.username,password=_ref$payload.password,history=_ref$payload.history;_context.prev=1;if(!(process.env.REACT_APP_DEFAULTAUTH===\"firebase\")){_context.next=10;break;}_context.next=5;return call(fireBaseBackend.loginUser,username,password);case 5:response=_context.sent;_context.next=8;return put(loginUserSuccess(response));case 8:_context.next=16;break;case 10:_context.next=12;return call(create,'/login',{username:username,password:password});case 12:_response=_context.sent;localStorage.setItem(\"authUser\",JSON.stringify(_response));_context.next=16;return put(loginUserSuccess(_response));case 16:history.push('/dashboard');_context.next=23;break;case 19:_context.prev=19;_context.t0=_context[\"catch\"](1);_context.next=23;return put(apiError(_context.t0));case 23:case\"end\":return _context.stop();}}},_marked,null,[[1,19]]);}/**\r\n * Logout the user\r\n * @param {*} param0 \r\n */function logout(_ref2){var history;return _regeneratorRuntime.wrap(function logout$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:history=_ref2.payload.history;_context2.prev=1;localStorage.removeItem(\"authUser\");if(!(process.env.REACT_APP_DEFAULTAUTH==='firebase')){_context2.next=6;break;}_context2.next=6;return call(fireBaseBackend.logout);case 6:_context2.next=8;return call(function(){history.push(\"/login\");});case 8:_context2.next=12;break;case 10:_context2.prev=10;_context2.t0=_context2[\"catch\"](1);case 12:case\"end\":return _context2.stop();}}},_marked2,null,[[1,10]]);}/**\r\n * Register the user\r\n */function register(_ref3){var user,email,password,response,_response2;return _regeneratorRuntime.wrap(function register$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:user=_ref3.payload.user;_context3.prev=1;email=user.email;password=user.password;if(!(process.env.REACT_APP_DEFAULTAUTH===\"firebase\")){_context3.next=12;break;}_context3.next=7;return call(fireBaseBackend.registerUser,email,password);case 7:response=_context3.sent;_context3.next=10;return put(registerUserSuccess(response));case 10:_context3.next=17;break;case 12:_context3.next=14;return call(create,'/register',user);case 14:_response2=_context3.sent;_context3.next=17;return put(registerUserSuccess(_response2));case 17:_context3.next=23;break;case 19:_context3.prev=19;_context3.t0=_context3[\"catch\"](1);_context3.next=23;return put(apiError(_context3.t0));case 23:case\"end\":return _context3.stop();}}},_marked3,null,[[1,19]]);}/**\r\n * forget password\r\n */function forgetPassword(_ref4){var email,response,_response3;return _regeneratorRuntime.wrap(function forgetPassword$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:email=_ref4.payload.email;_context4.prev=1;if(!(process.env.REACT_APP_DEFAULTAUTH===\"firebase\")){_context4.next=11;break;}_context4.next=5;return call(fireBaseBackend.forgetPassword,email);case 5:response=_context4.sent;if(!response){_context4.next=9;break;}_context4.next=9;return put(forgetPasswordSuccess(\"Reset link are sended to your mailbox, check there first\"));case 9:_context4.next=16;break;case 11:_context4.next=13;return call(create,'/forget-pwd',{email:email});case 13:_response3=_context4.sent;_context4.next=16;return put(forgetPasswordSuccess(_response3));case 16:_context4.next=22;break;case 18:_context4.prev=18;_context4.t0=_context4[\"catch\"](1);_context4.next=22;return put(apiError(_context4.t0));case 22:case\"end\":return _context4.stop();}}},_marked4,null,[[1,18]]);}export function watchLoginUser(){return _regeneratorRuntime.wrap(function watchLoginUser$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_context5.next=2;return takeEvery(LOGIN_USER,login);case 2:case\"end\":return _context5.stop();}}},_marked5);}export function watchLogoutUser(){return _regeneratorRuntime.wrap(function watchLogoutUser$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:_context6.next=2;return takeEvery(LOGOUT_USER,logout);case 2:case\"end\":return _context6.stop();}}},_marked6);}export function watchRegisterUser(){return _regeneratorRuntime.wrap(function watchRegisterUser$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:_context7.next=2;return takeEvery(REGISTER_USER,register);case 2:case\"end\":return _context7.stop();}}},_marked7);}export function watchForgetPassword(){return _regeneratorRuntime.wrap(function watchForgetPassword$(_context8){while(1){switch(_context8.prev=_context8.next){case 0:_context8.next=2;return takeEvery(FORGET_PASSWORD,forgetPassword);case 2:case\"end\":return _context8.stop();}}},_marked8);}function authSaga(){return _regeneratorRuntime.wrap(function authSaga$(_context9){while(1){switch(_context9.prev=_context9.next){case 0:_context9.next=2;return all([fork(watchLoginUser),fork(watchLogoutUser),fork(watchRegisterUser),fork(watchForgetPassword)]);case 2:case\"end\":return _context9.stop();}}},_marked9);}export default authSaga;","map":{"version":3,"sources":["/home/burak/projects/chat/frontend/src/redux/auth/saga.js"],"names":["login","logout","register","forgetPassword","watchLoginUser","watchLogoutUser","watchRegisterUser","watchForgetPassword","authSaga","all","call","fork","put","takeEvery","APIClient","getFirebaseBackend","LOGIN_USER","LOGOUT_USER","REGISTER_USER","FORGET_PASSWORD","loginUserSuccess","registerUserSuccess","forgetPasswordSuccess","apiError","fireBaseBackend","create","payload","username","password","history","process","env","REACT_APP_DEFAULTAUTH","loginUser","response","localStorage","setItem","JSON","stringify","push","removeItem","user","email","registerUser"],"mappings":"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","sourcesContent":["import { all, call, fork, put, takeEvery } from 'redux-saga/effects';\r\n\r\nimport { APIClient } from '../../helpers/apiClient';\r\nimport { getFirebaseBackend } from \"../../helpers/firebase\";\r\n\r\n\r\nimport {\r\n    LOGIN_USER,\r\n    LOGOUT_USER,\r\n    REGISTER_USER,\r\n    FORGET_PASSWORD\r\n} from './constants';\r\n\r\n\r\nimport {\r\n    loginUserSuccess,\r\n    registerUserSuccess,\r\n    forgetPasswordSuccess,\r\n    apiError\r\n} from './actions';\r\n\r\n\r\n//Initilize firebase\r\nconst fireBaseBackend = getFirebaseBackend();\r\n\r\n\r\n/**\r\n * Sets the session\r\n * @param {*} user \r\n */\r\n\r\nconst create = new APIClient().create;\r\n\r\n/**\r\n * Login the user\r\n * @param {*} payload - username and password \r\n */\r\nfunction* login({ payload: { username, password, history } }) {\r\n    try {\r\n        if(process.env.REACT_APP_DEFAULTAUTH === \"firebase\") {\r\n            const response = yield call(fireBaseBackend.loginUser, username, password);\r\n            yield put(loginUserSuccess(response));\r\n            \r\n        } else {\r\n            const response = yield call(create, '/login', { username, password });\r\n            localStorage.setItem(\"authUser\", JSON.stringify(response));\r\n            yield put(loginUserSuccess(response));\r\n           \r\n            \r\n        }\r\n        history.push('/dashboard');\r\n    } catch (error) {\r\n        yield put(apiError(error));\r\n    }\r\n}\r\n\r\n\r\n/**\r\n * Logout the user\r\n * @param {*} param0 \r\n */\r\nfunction* logout({ payload: { history } }) {\r\n    try {\r\n        localStorage.removeItem(\"authUser\");\r\n        if (process.env.REACT_APP_DEFAULTAUTH === 'firebase') {\r\n            yield call(fireBaseBackend.logout);\r\n        }\r\n        yield call(() => {\r\n            history.push(\"/login\");\r\n        });\r\n    } catch (error) { }\r\n}\r\n\r\n/**\r\n * Register the user\r\n */\r\nfunction* register({ payload: { user } }) {\r\n    try {\r\n        const email = user.email;\r\n        const password = user.password;\r\n        if(process.env.REACT_APP_DEFAULTAUTH === \"firebase\"){\r\n            const response = yield call(fireBaseBackend.registerUser, email, password);\r\n            yield put(registerUserSuccess(response));\r\n        } else {\r\n            const response = yield call(create, '/register', user);\r\n            yield put(registerUserSuccess(response));\r\n        }\r\n        \r\n    } catch (error) {\r\n        yield put(apiError(error));\r\n    }\r\n}\r\n\r\n/**\r\n * forget password\r\n */\r\nfunction* forgetPassword({ payload: { email } }) {\r\n    try {\r\n        if(process.env.REACT_APP_DEFAULTAUTH === \"firebase\"){\r\n            const response = yield call(fireBaseBackend.forgetPassword, email);\r\n            if (response) {\r\n              yield put(\r\n                forgetPasswordSuccess(\r\n                  \"Reset link are sended to your mailbox, check there first\"\r\n                )\r\n              );\r\n            }\r\n        } else {\r\n            const response = yield call(create, '/forget-pwd', { email });\r\n            yield put(forgetPasswordSuccess(response));\r\n        }\r\n    } catch (error) {\r\n        yield put(apiError(error));\r\n    }\r\n}\r\n\r\n\r\nexport function* watchLoginUser() {\r\n    yield takeEvery(LOGIN_USER, login);\r\n}\r\n\r\nexport function* watchLogoutUser() {\r\n    yield takeEvery(LOGOUT_USER, logout);\r\n}\r\n\r\nexport function* watchRegisterUser() {\r\n    yield takeEvery(REGISTER_USER, register);\r\n}\r\n\r\nexport function* watchForgetPassword() {\r\n    yield takeEvery(FORGET_PASSWORD, forgetPassword);\r\n}\r\n\r\nfunction* authSaga() {\r\n    yield all([\r\n        fork(watchLoginUser),\r\n        fork(watchLogoutUser),\r\n        fork(watchRegisterUser),\r\n        fork(watchForgetPassword),\r\n    ]);\r\n}\r\n\r\nexport default authSaga;"]},"metadata":{},"sourceType":"module"}